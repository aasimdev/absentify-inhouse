export const htmlConst = (params : {
  h1: string;
  firstLine: string;
  secondLine: string;
  thirdLine: string;
  fourthLine: string;
  fifthLine?: string;
  buttonText: string;
  pageTitle: string;
  link: string;
  teamsLink: string | null;
  teamsLinkText: string | null;
  approvers: { name: string; image: string; status: string }[] | null;
  company_image_url: string | null;
}) => `<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="format-detection" content="telephone=no"><meta name="viewport" content="width=device-width,initial-scale=1"><title></title><style type="text/css" emogrify="no">#outlook a{padding:0}.ExternalClass{width:100%}.ExternalClass,.ExternalClass div,.ExternalClass font,.ExternalClass p,.ExternalClass span,.ExternalClass td{line-height:100%}table td{border-collapse:collapse;mso-line-height-rule:exactly}.editable.image{font-size:0!important;line-height:0!important}.nl2go_preheader{display:none!important;mso-hide:all!important;mso-line-height-rule:exactly;visibility:hidden!important;line-height:0!important;font-size:0!important}body{width:100%!important;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;margin:0;padding:0}img{outline:0;text-decoration:none;-ms-interpolation-mode:bicubic}a img{border:none}table{border-collapse:collapse;mso-table-lspace:0;mso-table-rspace:0}th{font-weight:400;text-align:left}[class=gmail-fix]{display:none!important}</style><style type="text/css" emogrify="no">@media (max-width:600px){.gmx-killpill{content:' \u03D1'}}</style><style type="text/css" emogrify="no">@media (max-width:600px){.gmx-killpill{content:' \u03D1'}.r0-o{border-style:solid!important;margin:0 auto 0 auto!important;width:320px!important}.r1-i{background-color:#eff2f7!important}.r2-c{box-sizing:border-box!important;text-align:center!important;valign:top!important;width:100%!important}.r3-o{border-style:solid!important;margin:0 auto 0 auto!important;width:100%!important}.r4-i{background-color:#eff2f7!important;padding-bottom:20px!important;padding-left:15px!important;padding-right:15px!important;padding-top:20px!important}.r5-c{box-sizing:border-box!important;display:block!important;valign:top!important;width:100%!important}.r6-o{border-style:solid!important;width:100%!important}.r7-i{padding-left:0!important;padding-right:0!important}.r8-c{box-sizing:border-box!important;text-align:left!important;valign:top!important;width:100%!important}.r9-o{border-style:solid!important;margin:0 auto 0 0!important;width:100%!important}.r10-i{padding-bottom:20px!important;padding-top:15px!important;text-align:left!important}.r11-i{background-color:#fff!important;padding-bottom:10px!important;padding-left:10px!important;padding-right:10px!important;padding-top:20px!important}.r12-i{padding-top:15px!important;text-align:left!important}.r13-i{background-color:#fff!important;padding-bottom:0!important;padding-left:15px!important;padding-right:15px!important;padding-top:0!important}.r14-c{box-sizing:border-box!important;width:100%!important}.r15-i{padding-bottom:15px!important;padding-top:5px!important}.r16-i{background-color:#fff!important;padding-bottom:20px!important;padding-left:15px!important;padding-right:15px!important;padding-top:20px!important}.r17-o{border-style:solid!important;margin:0 auto 0 auto!important;margin-bottom:0!important;margin-top:30px!important;width:100%!important}.r18-i{text-align:center!important}.r19-r{background-color:#6264a7!important;border-color:#fdb900!important;border-radius:4px!important;border-width:0!important;box-sizing:border-box;height:initial!important;padding-bottom:12px!important;padding-left:5px!important;padding-right:5px!important;padding-top:12px!important;text-align:center!important;width:100%!important}.r20-o{border-style:solid!important;margin:0 auto 0 0!important;margin-bottom:15px!important;margin-top:5px!important;width:100%!important}.r21-i{padding-bottom:15px!important;padding-top:15px!important}.r22-i{color:#3b3f44!important;padding-bottom:15px!important;padding-top:15px!important;text-align:center!important}body{-webkit-text-size-adjust:none}.nl2go-responsive-hide{display:none}.nl2go-body-table{min-width:unset!important}.mobshow{height:auto!important;overflow:visible!important;max-height:unset!important;visibility:visible!important;border:none!important}.resp-table{display:inline-table!important}.magic-resp{display:table-cell!important}}</style><style type="text/css">h1,h2,h3,h4,ol,p,ul{margin:0}a,a:link{color:#fdb900;text-decoration:underline}.nl2go-default-textstyle{color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word}.default-button{color:#000;font-family:arial,helvetica,sans-serif;font-size:16px;font-style:normal;font-weight:700;line-height:1.15;text-decoration:none;word-break:break-word}.default-heading1{color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:36px;word-break:break-word}.default-heading2{color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:32px;word-break:break-word}.default-heading3{color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:24px;word-break:break-word}.default-heading4{color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:18px;word-break:break-word}a[x-apple-data-detectors]{color:inherit!important;text-decoration:inherit!important;font-size:inherit!important;font-family:inherit!important;font-weight:inherit!important;line-height:inherit!important}.no-show-for-you{border:none;display:none;float:none;font-size:0;height:0;line-height:0;max-height:0;mso-hide:all;overflow:hidden;table-layout:fixed;visibility:hidden;width:0}</style><!--[if mso]><xml><o:officedocumentsettings><o:allowpng><o:pixelsperinch>96</o:pixelsperinch></o:officedocumentsettings></xml><![endif]--><style type="text/css">a:link{color:#fdb900;text-decoration:underline}</style></head><body text="#3b3f44" link="#fdb900" yahoo="fix"><table cellspacing="0" cellpadding="0" border="0" role="presentation" class="nl2go-body-table" width="100%" style="background-color:#eff2f7;width:100%"><tr><td><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="600" align="center" class="r0-o" style="table-layout:fixed;width:600px"><tr><td valign="top" class="r1-i" style="background-color:#eff2f7"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%"><tr><td class="r4-i" style="background-color:#eff2f7;padding-bottom:20px;padding-top:20px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><th width="100%" valign="top" class="r5-c" style="font-weight:400"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r6-o" style="table-layout:fixed;width:100%"><tr><td valign="top" class="r7-i" style="padding-left:10px;padding-right:10px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><td class="r8-c" align="left"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r9-o" style="table-layout:fixed;width:100%"><tr><td align="left" valign="top" class="r10-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word;padding-bottom:20px;padding-top:15px;text-align:left"><div><h2 class="default-heading2" style="margin:0;color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:32px;word-break:break-word">${params.h1 ? params.h1 : ''}</h2></div></td></tr></table></td></tr></table></td></tr></table></th></tr></table></td></tr></table><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%"><tr><td class="r11-i" style="background-color:#fff;padding-bottom:10px;padding-left:15px;padding-right:15px;padding-top:20px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><th width="100%" valign="top" class="r5-c" style="font-weight:400"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r6-o" style="table-layout:fixed;width:100%"><tr><td valign="top" class="r7-i"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><td class="r8-c" align="left"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r9-o" style="table-layout:fixed;width:100%"><tr><td align="left" valign="top" class="r12-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word;padding-top:15px;text-align:left"><div><h3 class="default-heading3" style="margin:0;color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:24px;word-break:break-word">${params.firstLine ? params.firstLine : ''}</h3></div></td></tr></table></td></tr><tr><td class="r8-c" align="left"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r9-o" style="table-layout:fixed;width:100%"><tr><td align="left" valign="top" class="r12-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word;padding-top:15px;text-align:left;word-wrap:break-word"><div><h4 class="default-heading4" style="margin:0;color:#1f2d3d;font-family:arial,helvetica,sans-serif;font-size:18px;word-break:break-word;margin-bottom:10px">${params.secondLine ? params.secondLine : ''}</h4><p style="margin:0"></p><p style="margin:0">${params.thirdLine ? params.thirdLine : ''}</p><p style="margin:0"></p><p style="margin:0">${params.fourthLine ? params.fourthLine : ''}</p></div></td></tr></table></td></tr></table></td></tr></table></th></tr></table></td></tr></table><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%">${approversArray(params.approvers)}</table><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%"><tr>${params.fifthLine ? `<td class="r13-i" style="background-color:#fff;padding-left:15px;padding-right:15px;padding-top:10px;font-family:arial,helvetica,sans-serif;"><div><p style="margin:0"></p><p style="margin:0">${params.fifthLine}</p></div></td>` : ''}</tr></table><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%"><tr><td class="r16-i" style="background-color:#fff;padding-bottom:20px;padding-top:20px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><th width="100%" valign="top" class="r5-c" style="font-weight:400"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r6-o" style="table-layout:fixed;width:100%"><tr><td valign="top" class="r7-i" style="padding-left:15px;padding-right:15px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><td class="r2-c" align="center"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="285" class="r17-o" style="table-layout:fixed;width:285px"><tr class="nl2go-responsive-hide"><td height="30" style="font-size:30px;line-height:30px">­</td></tr><tr><td height="18" align="center" valign="top" class="r18-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word"><!--[if mso]><v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="${params.link ? params.link : ''}" style="v-text-anchor:middle;height:41px;width:284px" arcsize="10%" fillcolor="#6264a7" strokecolor="#6264a7" strokeweight="1px" data-btn="1"><w:anchorlock></w:anchorlock><v:textbox inset="0,0,0,0"><div style="display:none"><center class="default-button"><span><span style="color:#fff">${params.buttonText ? params.buttonText : ''} →</span></span></center></div></v:textbox></v:roundrect><![endif]--><!--[if !mso]><!-- --><a href="${params.link ? params.link : ''}" class="r19-r default-button" target="_blank" data-btn="1" style="font-style:normal;font-weight:700;line-height:1.15;text-decoration:none;word-break:break-word;border-style:solid;word-wrap:break-word;display:inline-block;-webkit-text-size-adjust:none;background-color:#6264a7;border-color:#fdb900;border-radius:4px;border-width:0;color:#000;font-family:arial,helvetica,sans-serif;font-size:16px;height:18px;mso-hide:all;padding-bottom:12px;padding-left:5px;padding-right:5px;padding-top:12px;width:275px"><span><span style="color:#fff">${params.buttonText ? params.buttonText : ''} →</span></span></a><!--<![endif]--></td></tr></table></td></tr><tr><td class="r8-c" align="left"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r20-o" style="table-layout:fixed;width:100%"><tr class="nl2go-responsive-hide"><td height="5" style="font-size:5px;line-height:5px">­</td></tr><tr><td align="center" valign="top" class="r18-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;word-break:break-word;line-height:1;text-align:center"><div><p style="margin:0"><a href="${params.teamsLink ? params.teamsLink : ''}" target="_blank" style="color:#fdb900;text-decoration:underline"><span style="color:#858588;font-family:Arial,helvetica,sans-serif;font-size:12px"><u>${params.teamsLinkText ? params.teamsLinkText : ''}</u></span></a></p></div></td></tr><tr class="nl2go-responsive-hide"><td height="15" style="font-size:15px;line-height:15px">­</td></tr></table></td></tr></table></td></tr></table></th></tr></table></td></tr></table><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" align="center" class="r3-o" style="table-layout:fixed;width:100%"><tr><td class="r4-i" style="background-color:#eff2f7;padding-bottom:20px;padding-top:20px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><th width="100%" valign="top" class="r5-c" style="font-weight:400"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r6-o" style="table-layout:fixed;width:100%"><tr><td valign="top" class="r7-i" style="padding-left:15px;padding-right:15px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation">${absentifyOrCompanyLogo(params.company_image_url)}<tr><td class="r8-c" align="left"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r9-o" style="table-layout:fixed;width:100%"><tr><td align="center" valign="top" class="r22-i nl2go-default-textstyle" style="font-family:arial,helvetica,sans-serif;word-break:break-word;color:#3b3f44;font-size:18px;line-height:1.5;padding-bottom:15px;padding-top:15px;text-align:center"></td></tr></table></td></tr></table></td></tr></table></th></tr></table></td></tr></table></td></tr></table></td></tr></table></body></html>`;

const approversArray = (approvers: {image: string, name: string, status: string}[] | null): string => {
  if (!approvers) return '';
  let result = '';
  for (const approver of approvers) {
    const html = `
    <tr><td class="r13-i" style="background-color:#fff"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><th width="100%" valign="top" class="r5-c" style="font-weight:400"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="100%" class="r6-o" style="table-layout:fixed;width:100%"><tr><td valign="top" class="r7-i" style="padding-left:15px;padding-right:15px"><table width="100%" cellspacing="0" cellpadding="0" border="0" role="presentation"><tr><td class="r14-c"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="570" class="r6-o" style="table-layout:fixed;width:570px"><tr><td class="r15-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word;padding-bottom:15px;padding-top:5px"><div style="display:flex;align-items:center"><div><img src="${approver.image}" alt="" style="width:35px;height:35px;border-radius:9999px" /></div><div style="margin-left:.75rem"><p style="margin:0;color:#374151;font-size:18px;line-height:1.25rem;font-weight:500">${approver.name}</p><p style="margin:0;color:#6b7280;font-size:14px;line-height:1rem;font-weight:500">${approver.status}</p></div></div></td></tr></table></td></tr></table></td></tr></table></th></tr></table></td></tr>
    `
    result = result + html;
  }
  return result;
}


const absentifyOrCompanyLogo = (logo: string | null): string => {
  if(logo) {
    return `
    <tr><td class="r14-c"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="570" class="r6-o" style="table-layout:fixed;width:570px"><tr><td class="r21-i nl2go-default-textstyle" style="color:#3b3f44;font-family:arial,helvetica,sans-serif;font-size:16px;line-height:1.5;word-break:break-word;padding-bottom:15px;padding-top:15px"><div style="text-align:center"><img src="${logo}" style="width:200px;vertical-align:top;opacity:1;margin:0;height:100%"></div></td></tr></table></td></tr>`
  }
    return `<tr><td class="r2-c" align="center"><table cellspacing="0" cellpadding="0" border="0" role="presentation" width="200" class="r3-o" style="table-layout:fixed;width:200px"><tr><td style="font-size:0;line-height:0"><a href="https://absentify.com" target="_blank" style="color:#fdb900;text-decoration:underline"><img src="https://img.mailinblue.com/4606254/images/content_library/original/626525ce49f0941db7458034.png" width="200" border="0" style="display:block;width:100%"></a></td></tr></table></td></tr>`
  
}